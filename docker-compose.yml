version: '2'

volumes:
    database_data:
        driver: local

services:
    web:
        build: .
        ports:
            - 80
        links:
            - mysql
        depends_on:
            - mysql
        volumes:
            - ./mysite:/app/mysite
            - ./themes:/app/themes
            - ./assets:/app/assets
            - ./scripts:/app/scripts
            - ./surveys:/app/surveys
            - ./phpunit.xml:/app/phpunit.xml
        environment:
            DB_HOST: mysql
            DB_USER: user
            DB_PASS: secret
            DB_NAME: make-place
            SITE_ENV: dev
            DEFAULT_USER: rob@veodesign.co.uk
            DEFAULT_PASS: password
            PATH: '$PATH:/app/scripts'
    
    mysql:
        image: mysql:latest
        ports:
            - 3306:3306
        volumes:
            - database_data:/var/lib/mysql
        environment:
            MYSQL_ROOT_PASSWORD: secret
            MYSQL_DATABASE: make-place
            MYSQL_USER: user
            MYSQL_PASSWORD: secret
